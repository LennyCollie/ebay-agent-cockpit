{% extends "base.html" %}
{% block title %}Suchergebnisse{% endblock %}
{% block content %}
<h1 class="h3 mb-3">Suchergebnisse</h1>

{% if terms %}
<p class="mb-3">Gesucht nach:
  {% for t in terms %}
    <span class="badge bg-light text-dark me-1">{{ t }}</span>
  {% endfor %}
</p>
{% endif %}

{% if results %}
<div class="table-responsive">
  <table class="table align-middle">
    <thead>
      <tr><th style="width:80px">Bild</th><th>Titel</th><th style="width:160px">Preis</th><th style="width:160px">Aktion</th></tr>
    </thead>
    <tbody>
      {% for r in results %}
      <tr>
        <td>
          {% if r.img %}
            <img src="{{ r.img }}" alt="" class="img-thumbnail" style="width:72px; height:auto;">
          {% endif %}
        </td>
        <td>
          <div class="d-flex flex-column">
            <div class="fw-semibold">{{ r.title }}</div>
            {% if r.term %}
              <small class="text-muted">Suchbegriff: „{{ r.term }}“</small>
            {% endif %}
            {% set src = r.source or 'ebay' %}
            <div class="mt-1">
              <span class="badge badge-src {{ 'bg-warning text-dark' if src=='amazon' else 'bg-primary' }}">
                {{ 'Amazon' if src=='amazon' else 'eBay' }}
              </span>
            </div>
          </div>
        </td>
        <td>{{ r.price or '–' }}</td>
        <td>
          {% if r.url %}
          <a class="btn btn-sm btn-outline-primary" href="{{ r.url }}" target="_blank" rel="noopener">
            Auf {{ 'Amazon' if (r.source or '')=='amazon' else 'eBay' }} öffnen
          </a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
  <div class="alert alert-info">Keine Ergebnisse.</div>
{% endif %}
{% endblock %}