{% extends "base.html" %}
{% block title %}Suche – ebay-agent-cockpit{% endblock %}

{% block content %}
<h1 class="mb-3">Suche</h1>

<p class="text-secondary">
  {% if is_premium %}
    Premium: bis zu {{ limit }} Begriffe gleichzeitig.
  {% else %}
    Kostenlos: bis zu {{ limit }} Begriffe gleichzeitig.
  {% endif %}
</p>

<form action="{{ url_for('search') }}" method="post" class="mb-4">
  <div class="row g-2">
    {% for i in range(1, limit+1) %}
      <div class="col-12 col-sm-6 col-lg-4">
        <input
          class="form-control"
          type="text"
          name="term{{ i }}"
          placeholder="Suchbegriff {{ i }}"
          value="{{ terms[i-1] if terms|length >= i else '' }}"
        >
      </div>
    {% endfor %}
  </div>
  <div class="mt-3">
    <button class="btn btn-primary">Suchen</button>
    <a class="btn btn-outline-secondary" href="{{ url_for('search') }}">Zurücksetzen</a>
  </div>
</form>

{% if results is not none %}
  {% if results %}
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th style="width:72px">Bild</th>
            <th>Titel</th>
            <th style="width:140px">Preis</th>
            <th style="width:140px">Aktion</th>
          </tr>
        </thead>
        <tbody>
        {% for r in results %}
          <tr>
            <td><img src="{{ r.thumb }}" alt="" class="rounded" width="64" height="64"></td>
            <td>
              <div class="fw-semibold">{{ r.title }}</div>
              <div class="text-secondary small">Suchbegriff: „{{ r.term }}“</div>
            </td>
            <td class="fw-semibold">{{ r.price }}</td>
            <td>
              <a class="btn btn-sm btn-outline-primary" href="{{ r.url }}" target="_blank" rel="noopener">
                Auf eBay öffnen
              </a>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info">Keine Treffer gefunden.</div>
  {% endif %}
{% endif %}
{% endblock %}