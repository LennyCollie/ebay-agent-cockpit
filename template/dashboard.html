<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>eBay Agent Cockpit</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans leading-normal tracking-normal">

  <div class="max-w-4xl mx-auto p-6 mt-8 bg-white rounded-xl shadow-md">
    <h1 class="text-3xl font-bold text-gray-800 mb-4">📦 eBay Agent Cockpit</h1>

    <!-- Flash-Nachrichten -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="mb-4">
          {% for category, message in messages %}
            <li class="p-3 mb-2 rounded bg-{{ 'green' if category == 'success' else 'red' if category == 'danger' else 'yellow' }}-100 text-{{ 'green' if category == 'success' else 'red' if category == 'danger' else 'yellow' }}-800">
              {{ message }}
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <!-- Upgrade-Status -->
    <div class="mb-6">
      {% if is_premium %}
        <p class="text-green-600 font-semibold">✅ Du bist ein <strong>PREMIUM</strong>-Nutzer!</p>
      {% else %}
        <form action="{{ url_for('create_checkout_session') }}" method="post">
          <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded">
            🚀 Upgrade auf PREMIUM
          </button>
        </form>
      {% endif %}
    </div>

    <!-- Agent starten -->
    <form method="post" action="{{ url_for('run_agent') }}">
      <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        ▶️ Agent ausführen
      </button>
    </form>

    <!-- Aufträge anzeigen -->
    <div class="mt-6">
      <h2 class="text-xl font-semibold mb-2">📝 Aktive Aufträge:</h2>
      {% if auftraege %}
        <ul class="list-disc pl-5 text-gray-700">
          {% for eintrag in auftraege %}
            <li>{{ eintrag.name }} – <em>{{ eintrag.keywords }}</em></li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-500">Noch keine Aufträge vorhanden.</p>
      {% endif %}
    </div>

    <!-- Logs anzeigen -->
    <div class="mt-6">
      <h2 class="text-xl font-semibold mb-2">🛠 Letzte Log-Ausgaben:</h2>
      <pre class="bg-gray-200 p-4 rounded overflow-x-auto text-sm text-gray-800 max-h-64">{{ logs|join('') }}</pre>
    </div>
  </div>

</body>
</html>
